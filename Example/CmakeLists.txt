cmake_minimum_required(VERSION 3.16)

project(CasulliExample LANGUAGES CXX)

# Example source (this CMakeLists.txt is inside Example/)
set(CASULLI_EXAMPLE_SRC "${CMAKE_CURRENT_SOURCE_DIR}/Casulliwrap.cpp")

function(configure_casulli_target tgt)
  target_sources(${tgt} PRIVATE "${CASULLI_EXAMPLE_SRC}")

  # code uses std::span / std::optional etc.
  target_compile_features(${tgt} PRIVATE cxx_std_20)

  # New include roots for your new repo structure:
  #   PDEs/      (old source/fcfd/pdemodel)
  #   Numerics/  (old source/fcfd/pdenumerics)
  #   Utils/     (old source/fcfd/itertools)
  #
  # Also keep repo root so relative includes (if any) still work.
  target_include_directories(${tgt} PRIVATE
    "${CMAKE_CURRENT_SOURCE_DIR}/.."        # repo root
    "${CMAKE_CURRENT_SOURCE_DIR}/../PDEs"
    "${CMAKE_CURRENT_SOURCE_DIR}/../Numerics"
    "${CMAKE_CURRENT_SOURCE_DIR}/../Utils"
  )

  # Basic warnings
  if(MSVC)
    target_compile_options(${tgt} PRIVATE /W4)
  else()
    target_compile_options(${tgt} PRIVATE -Wall -Wextra -Wpedantic)
  endif()
endfunction()

# ---- Build 1D executable ----
add_executable(casulli_1d)
configure_casulli_target(casulli_1d)
target_compile_definitions(casulli_1d PRIVATE CASE_1D)

# ---- Build 2D executable ----
add_executable(casulli_2d)
configure_casulli_target(casulli_2d)
target_compile_definitions(casulli_2d PRIVATE CASE_2D)
